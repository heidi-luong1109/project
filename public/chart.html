

<html>

<head>


<title>bitmex xbtusd</title>
<meta name="viewport" content="width=device-width">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<link rel="stylesheet" href="css/probar_m.css">
<script src="https://code.jquery.com/jquery-1.12.3.min.js" ></script>
1
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>


	<style>
	canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

body{

	font-family:'Arial';
}


.btn_act {
	font-size:0.8rem;width:120px;height:100%;border:1px solid #000;background:linear-gradient( to bottom, #efefef, #999 );color:#000;
}



.btn_chart {

	font-size:0.8rem;height:30px;border:1px solid #000;background:#efefef;color:#000;width:80px;
}

.btn_chart2 {

	font-size:0.8rem;height:30px;border:1px solid #000;background:#13c600;color:#fff;width:80px;
}




.t1{
	border-right:1px solid #000;
}
.t2{
	border-right:1px solid #000;
	;padding-right:5px;text-align:right;
}
.c1{

color:#ff0000;border-right:1px solid #000;padding-right:5px;text-align:right;
}
.c2{

 color:#009619;border-right:1px solid #000;padding-right:5px;text-align:right;
}

.c3{

color:#000000;border-right:1px solid #000;padding-right:5px;text-align:right;
}
@import url(https://fonts.googleapis.com/css?family=Oxygen+Mono);
/* Starter CSS for Menu */
#cssmenu {
  padding: 0;
  margin: 0;
  border: 0;
  width: auto;
}
#cssmenu ul,
#cssmenu li {
  list-style: none;
  margin: 0;
  padding: 0;
}
#cssmenu ul {
  position: relative;
  z-index: 597;
}
#cssmenu ul li {
  float: left;
  min-height: 1px;
  vertical-align: middle;
}
#cssmenu ul li.hover,
#cssmenu ul li:hover {
  position: relative;
  z-index: 599;
  cursor: default;
}
#cssmenu ul ul {
  visibility: hidden;
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 598;
  width: 100%;
}
#cssmenu ul ul li {
  float: none;
}
#cssmenu ul ul ul {
  top: 0;
  left: 190px;
  width: 190px;
}
#cssmenu ul li:hover > ul {
  visibility: visible;
}
#cssmenu ul ul {
  bottom: 0;
  left: 0;
}
#cssmenu ul ul {
  margin-top: 0;
}
#cssmenu ul ul li {
  font-weight: normal;
}
#cssmenu a {
  display: block;
  line-height: 1em;
  text-decoration: none;
}
/* Custom CSS Styles */
#cssmenu {
  background: #333;
  border-bottom: 4px solid #1b9bff;
  font-family: 'Oxygen Mono', Tahoma, Arial, sans-serif;
  font-size: 1rem;
}
#cssmenu > ul {
  *display: inline-block;
}
#cssmenu:after,
#cssmenu ul:after {
  content: '';
  display: block;
  clear: both;
}
#cssmenu ul {
  text-transform: uppercase;
}
#cssmenu ul ul {
  border-top: 4px solid #1b9bff;
  text-transform: none;
  min-width: 190px;
}
#cssmenu ul ul a {
  background: #1b9bff;
  color: #ffffff;
  border: 1px solid #0082e7;
  border-top: 0 none;
  line-height: 150%;
  padding: 16px 20px;
  font-size: 12px;
}
#cssmenu ul ul ul {
  border-top: 0 none;
}
#cssmenu ul ul li {
  position: relative;
}
#cssmenu ul ul li:first-child > a {
  border-top: 1px solid #0082e7;
}
#cssmenu ul ul li:hover > a {
  background: #4eb1ff;
  color: #ffffff;
}
#cssmenu ul ul li:last-child > a {
  -moz-border-radius: 0 0 3px 3px;
  -webkit-border-radius: 0 0 3px 3px;
  border-radius: 0 0 3px 3px;
  -moz-background-clip: padding;
  -webkit-background-clip: padding-box;
  background-clip: padding-box;
  -moz-box-shadow: 0 1px 0 #1b9bff;
  -webkit-box-shadow: 0 1px 0 #1b9bff;
  box-shadow: 0 1px 0 #1b9bff;
}
#cssmenu ul ul li:last-child:hover > a {
  -moz-border-radius: 0 0 0 3px;
  -webkit-border-radius: 0 0 0 3px;
  border-radius: 0 0 0 3px;
  -moz-background-clip: padding;
  -webkit-background-clip: padding-box;
  background-clip: padding-box;
}
#cssmenu ul ul li.has-sub > a:after {
  content: '+';
  position: absolute;
  top: 50%;
  right: 15px;
  margin-top: -8px;
}
#cssmenu ul li:hover > a,
#cssmenu ul li.active > a {
  background: #1b9bff;
  color: #ffffff;
}
#cssmenu ul li.has-sub > a:after {
  content: '+';
  margin-left: 5px;
}
#cssmenu ul li.last ul {
  left: auto;
  right: 0;
}
#cssmenu ul li.last ul ul {
  left: auto;
  right: 99.5%;
}
#cssmenu a {
  background: #333;
  color: #CBCBCB;
  padding: 0 20px;
}
#cssmenu > ul > li > a {
  line-height: 48px;
  font-size: 12px;
}
#cssmenu.align-center > ul {
  text-align: center;
  font-size: 0;
}
#cssmenu.align-center > ul > li {
  display: inline-block;
  float: none;
}
#cssmenu.align-center ul ul {
  text-align: left;
}
#cssmenu.align-right > ul > li {
  float: right;
}
#cssmenu.align-right ul ul {
  left: auto;
  right: 0;
  text-align: right;
}
#cssmenu.align-right ul ul ul {
  left: auto;
  right: 190px;
}
#cssmenu.align-right ul ul li.has-sub > a:after {
  left: 15px;
  right: auto;
}

</style>


<style type="text/css">



.sidenav {
    height: 100%;
    width: 0;
    position: fixed;
    z-index: 100;
    top: 150px;
    left: 0;
    background-color: #111;
    overflow-x: hidden;
    transition: 0.5s;
    padding-top: 20px;
}

.sidenav a {
    padding: 8px 8px 8px 32px;
    text-decoration: none;
    font-size: 1.6rem;
    color: #818181;
    display: block;
    transition: 0.3s;
}

.sidenav a:hover {
    color: #f1f1f1;
}

.sidenav .closebtn {
    position: absolute;
    top: 0;
    right: 25px;
    font-size: 40px;
    margin-left: 50px;
}

@media screen and (max-height: 400px) {
  .sidenav {padding-top: 15px;}
  .sidenav a {font-size: 1.8rem;}
}

#fixed-menu {
  width: 100%;
  background-color: #ffffff;
  position: fixed;
  top: 0px;
  left: 0px;
  z-index:99999;
}

#main-content {
  width: 100%;
  margin-top: 152px;
}



.sidenav_cart {
    height: 100%;
    width: 0;
    position: fixed;
    z-index: 100;
    top: 150px;
    right: 0;
    background-color: #111;
    overflow-x: hidden;
    transition: 0.5s;
    padding-top: 20px;
}

.sidenav_cart a {
    padding: 8px 8px 8px 32px;
    text-decoration: none;
    font-size: 1.6rem;
    color: #818181;
    display: block;
    transition: 0.3s;
}

.sidenav_cart a:hover {
    color: #f1f1f1;
}

.sidenav_cart .closebtn {
    position: absolute;
    top: 0;
    right: 25px;
    font-size: 40px;
    margin-left: 50px;
}

@media screen and (max-height: 400px) {
  .sidenav_cart {padding-top: 15px;}
  .sidenav_cart a {font-size: 1.8rem;}
}




body {font-size:0.8rem; margin:0; padding:0;}



.chat_btn {-webkit-appearance: none;display:inline-block; height:20px;width:40px;padding:0 0px 0; background-color:#ffffff; font-size:11px; color:#333333; line-height:20px;border-radius: 2px;vertical-align:middle;border: 1px solid #dedede; background-color:#ffffff;}
.chat_input {-webkit-appearance: none;display:inline-block; height:31px;width:333px; padding:0 10px 0; border:1px solid #d6d6d6; background-color:#ffffff; font-size:11px; color:#333333; line-height:31px;border-radius: 3px;vertical-align:middle}


    .st_money {
        font-family:Tahoma;color:#fff;font-size:0.7rem;
        border:1px solid #333;width:100%;text-align:center;
        background:linear-gradient( to bottom, #555, #444 );height:32px;cursor:pointer;
    }
    .st_money:hover {

        background:linear-gradient( to bottom, #444, #555 );
    }

    .vv_msg {
        font-family: 'Nanum Gothic', sans-serif;
        color:#333;font-size:12px;line-height:24px;
    }
    .vv_nick {
        font-family: 'Nanum Gothic', sans-serif;
        color:#333333;font-size:12px;line-height:24px;font-weight:bold;
    }
    .vv_info {
         font-family:Tahoma;color:#808080;font-size:12px;
    }
    .vv_notice {
         font-family: 'Nanum Gothic', sans-serif;font-weight:bold;height:28px;line-height:28px;
         color:#000000;font-size:12px;
    }
    .vv_alert {
         font-family:Tahoma;color:#f35632;font-size:12px;
    }
    .v_short0 {
         font-family:Tahoma;color:#fa7661;font-size:0.7rem;
    }
    .v_short {
         font-family:Tahoma;color:#ff4628;font-size:0.7rem;
    }



    .v_short_order_btn {
        height:26px;
        font-size:0.8rem;
        font-family:Tahoma;color:#ffffff;font-size:0.8rem;cursor:pointer;
        border-bottom:1px solid #3d211c;

    }
        .v_short_order_btn:hover {
            color:#52C66C;
        }


    .v_long_order_btn {
        height:26px;
        font-size:0.8rem;
        font-family:Tahoma;color:#ffffff;font-size:0.8rem;cursor:pointer;
        border-bottom:1px solid #3d211c;

    }

    .v_long_order_btn:hover {
        color:#52C66C;
    }



    .v_long {
         font-family:Tahoma;color:#43AA5A;font-size:0.7rem;
    }
    .v_long0 {
         font-family:Tahoma;color:#43AA5A;font-size:0.7rem;
    }


   .v_none {
         font-family:Tahoma;color:#eee;font-size:0.7rem;border-bottom:1px solid #3d211c;padding-right:5px;padding-left:5px;height:26px;
    }
   .v_none1 {
         font-family:Tahoma;color:#aaa;font-size:0.7rem;border-bottom:1px solid #3d211c;padding-right:5px;padding-left:5px;height:26px;
    }




    .btn_buy {
         font-family:Tahoma;color:#fff;background:linear-gradient( to bottom, #43AA5A, #43AA5A );border:1px solid #111;font-size:0.8rem;cursor:pointer;
    }
    .btn_buy:hover {
         background:linear-gradient( to bottom, #43AA5A, #43AA5A );
    }
    .btn_sell {
         font-family:Tahoma;color:#fff;background:linear-gradient( to bottom, #fe6f58, #ff4122 );border:1px solid #111;font-size:0.8rem;cursor:pointer;
    }
    .btn_sell:hover {
         background:linear-gradient( to bottom, #ff4122, #fe6f58 );
    }

    .btn_stop {
         font-family:Tahoma;color:#fff;background:linear-gradient( to bottom, #999, #555 );border:1px solid #111;font-size:0.8rem;height:45px;width:100%;cursor:pointer;
    }
    .btn_stop:hover {
         background:linear-gradient( to bottom, #ff0000, #ff4628 );
    }

    .v_orders_sell {
        font-family:Tahoma;color:#fff;
        font-size:0.7rem;
        background:linear-gradient( to bottom, #fe6f58, #ff4122 );

        height:28px;

    }


    .v_orders_sell_btn {
        font-family:Tahoma;color:#fff;
        font-size:0.7rem;
        background:linear-gradient( to bottom, #fe6f58, #ff4122 );

        height:28px;
        cursor:pointer;

    }

    .v_orders_sell_btn:hover {
        color:#52C66C;

    }

    .v_orders_buy {
        font-family:Tahoma;color:#fff;
        font-size:0.7rem;
        background:linear-gradient( to bottom, #43AA5A, #43AA5A );

        height:28px;
       cursor:pointer;
    }
    .v_orders_buy_btn {
        font-family:Tahoma;color:#fff;
        font-size:0.7rem;
        background:linear-gradient( to bottom, #43AA5A, #43AA5A );

        height:28px;

    }

    .v_orders_buy_btn:hover {
        color:#52C66C;

    }





    .btn_input_half {
        font-family:Tahoma;color:#fff;background:#333;width:40px;height:24px;text-align:center;border:1px solid #111;
        font-size:0.8rem;line-height:24px;
    }



    .btn_input {
        font-family:Tahoma;color:#fff;background:#333;width:100%;height:40px;text-align:center;border:1px solid #111;
        font-size:1rem;line-height:50px;
    }
    .scroll_buy {
        scrollbar-highlight-color: #FFFFFF;
        scrollbar-3dlight-color: #B58E63;
        scrollbar-face-color: #F2ECE6;
        scrollbar-shadow-color: #B58E63;
        scrollbar-darkshadow-color: white;
        scrollbar-track-color: #FFFFFF;
        scrollbar-arrow-color: #B58E63;
    }


    .btn_ac {
        color:#fff;cursor:pointer;
    }

    .btn_ac:hover {
            color:#52C66C;
    }

    .btn_ac_buy_price {
        color:#fff;cursor:pointer;
    }

    .btn_ac_buy_price:hover {
            color:#52C66C;
    }

   .btn_ac_cancel {
       background:linear-gradient( to bottom, #ccc, #555 );
       border:1px solid #111;
        color:#ccc;cursor:pointer;
        width:100%;
        height:30px;
    }

    .btn_ac_cancel:hover {
            color:#fff;
    }
</style>



<script language="javascript">

    var am = 0;

    var g_vol = 0.3;







    function fn_show(cnt) {
        var comma_separator_number_step = $.animateNumber.numberStepFactories.separator(',');
        $('#tot_usd').animateNumber({ number: cnt, numberStep: comma_separator_number_step }, 10000);
    }

    function fn_show_number(target, cnt) {
        var comma_separator_number_step = $.animateNumber.numberStepFactories.separator(',');
        $(target).animateNumber({ number: cnt, numberStep: comma_separator_number_step }, 10000);
    }



    var view_ratio = 5;


    var hc = 0;
    var hq = 0;

    var min_effect = 0;


    function numberWithCommas(n) {
        var parts = n.toString().split(".");
        return parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",") + (parts[1] ? "." + parts[1] : "");
    }





    var timer04;
    var timer05;

    function fn_tcs(tcs) {

        view_ratio = tcs;
        obj_ac.play();


    }

    function handleSelect(elm) {
        window.location = elm.value+".html";
    }


    var lang = 'KR';
    var mode = '2';

    function fn_set_lang(lang) {

        if (lang == 1) {
            window.open('?lang=EN&mode=2', '_self');
        } else {
            window.open('?lang=KR&mode=2', '_self');
        }
    }

    function fn_set_mode() {


        if (mode == 1) {
            window.open('?lang='+lang +'&mode=2', '_self');
        } else {
            window.open('?lang=' + lang + '&mode=1', '_self');
        }
    }

    function fn_set_1s() {

    }


</script>


</head>


<body style="font-family:Arial;font-size:0.9rem;background:#333;">
    <center>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
   
</table>
<table width="100%" border="0" cellpadding="0" cellspacing="0"  style="border:1px solid #333;border-collapse:collapse;font-size:0.9rem;" >


<tr>
	<td colspan="2" style="background:linear-gradient( to bottom, #777, #424444 );">






<style>
body { margin: 0; }


.sidenav {
    height: 100%;
    width: 0;
    position: fixed;
    z-index: 100;
    top: 30px;
    left: 0;
    background-color: #111;
    overflow-x: hidden;
    transition: 0.5s;
    padding-top: 20px;
}

.sidenav a {
    padding: 8px 8px 8px 32px;
    text-decoration: none;
    font-size: 1.6rem;
    color: #818181;
    display: block;
    transition: 0.3s;
}

.sidenav a:hover {
    color: #f1f1f1;
}

.sidenav .closebtn {
    position: absolute;
    top: 0;
    right: 25px;
    font-size: 40px;
    margin-left: 50px;
}

@media screen and (max-height: 400px) {
  .sidenav {padding-top: 15px;}
  .sidenav a {font-size: 1.8rem;}
}

#fixed-menu {
  width: 100%;
  background-color: #ffffff;
  position: fixed;
  top: 0px;
  left: 0px;
  z-index:99999;
}


#main-content {
  width: 100%;
  margin-top: 152px;
}



.sidenav_cart {
    height: 100%;
    width: 0;
    position: fixed;
    z-index: 200;
    top: 30px;
    right: 0;
    background-color: #111;
    overflow-x: hidden;
    transition: 0.5s;

}

.sidenav_cart a {
    padding: 8px 8px 8px 32px;
    text-decoration: none;
    font-size: 1.6rem;
    color: #818181;
    display: block;
    transition: 0.3s;
}

.sidenav_cart a:hover {
    color: #f1f1f1;
}

.sidenav_cart .closebtn {
    position: absolute;
    top: 0;
    right: 25px;
    font-size: 40px;
    margin-left: 50px;
}

@media screen and (max-height: 400px) {
  .sidenav_cart {padding-top: 15px;}
  .sidenav_cart a {font-size: 1.8rem;}
}

</style>


<script>
var side_view = 0;
var side_view2  = 0;
function openNav() {


    if ( side_view == 0){
        document.getElementById("mySidenav").style.width = "400px";
        side_view = 1;
    }else{
        document.getElementById("mySidenav").style.width = "0px";
        side_view = 0;
    }
}




</script>
<style>
.cm_rqs{background:linear-gradient( to bottom, #efefef, #ccc );color:#000;width:100px;height:20px;text-align:center;font-size:0.8rem;border-radius:5px;border:1px solid #ccc}

.cm_rqs:hover {background:linear-gradient( to bottom, #1e2635, #0c1524 );color:#fff}



</style>

	</td>
</tr>

</table>
<div id="api_bg" style="border:2px solid #111;width:400px">

    <table width="100%" border="0" cellspacing="0" cellpadding="0" >

            <tr>
                <td width="100%" style="padding:0px;">

	                    <table width="100%" border="0" cellpadding="0" cellspacing="0">

                                <tr>
                                <td align="center" width="100%" style="background:linear-gradient( to bottom, #999, #555 );padding:5px;">




                                    <table  border="0" cellpadding="0" cellspacing="0" width="100%">
                                        <tr>

                                            <td width="15%" align="center" class="v_long"  style="border:1px solid #333;border-radius:4px 0px 0px 4px;background:#333;font-size:0.6rem;" id="lamp_buy">
                                                $ <span id="vt_long"></span>

                                            </td>
                                            <td width="13%" align="center" style="border:1px solid #333;color:#fff;border-right:none;font-size:0.8rem;"><span id="vtp_long"></span></td>
                                            <td width="24%" align="center" style="border:1px solid #333;">



                        <select name="eml" onchange="javascript:handleSelect(this)"style="height:40px;width:100%;background:linear-gradient( to bottom, #fff, #777);color:#333;border:none;text-align:center;font-size:0.7rem;">
							<option value="chart">2xChart</option>
							<option value="Bitmex-XBTUSD">XBTUSD</option>
                            <option value="Bitmex-ETHUSD">ETHUSD</option>
                            <option value="Desktop">Desktop</option>

                            </select>



                                            </td>
                                            <td width="13%" align="center" style="border:1px solid #333;color:#fff;border-left:0px;font-size:0.8rem;"><span id="vtp_short"></span></td>
                                            <td width="15%" align="center"  class="v_short" style="border:1px solid #333;border-radius:0 4px 4px 0;background:#333;font-size:0.6rem;" id="lamp_sell">
                                               $ <span id="vt_short"></span>

                                            </td>
                                        </tr>

                                        </table>
                                </td>

                            </tr>
                            <tr>

                                        </tr>

                                        </table>
                                </td>
                            </tr>
                            </table>
                    <table width="100%" border="0" cellpadding="0" cellspacing="0">
                        <tr>
                            <td>
                                <div id="vm_chart";">
<script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
<div class="tradingview-widget-container">


              <script type="text/javascript">
                  new TradingView.widget(
                  {
                      "width": 400,
                      "height": 300,
                      "symbol": "BINANCE:BTCUSDTPERP",
                      "interval": "60",
                      "timezone": "Etc/UTC",
                      "theme": "Dark",
                      "style": "1",
                      "locale": "en",
                      "toolbar_bg": "#333",
                      "enable_publishing": false,
                      "hide_legend": true,
                      "save_image": false,
			"hide_side_toolbar": false,
                      "studies": [
                          "IchimokuCloud@tv-basicstudies"
                      ],
                      "container_id": "tradingview_5e52b"
                  }
                  );
              </script>
            </div>
</div>
                            </td>

                        </tr>
                            <tr>
                                <td align="center" width="100%" style="background:#333;border-left:1px solid #555;border-right:1px solid #555;background:#333;">

<table  border="0" cellpadding="0" cellspacing="0" width="100%">
                                          <tr>

                                            <td width="100%" align="center" valign="top" bgcolor="#111" colspan="6">


                                                    <table  border="0" cellpadding="0" cellspacing="0" width="100%" >
                                                        <tr>

                                                         

                                                          
                                                           

                                                            </td>
                                                        </tr>

                                                        </table>



                                              </td>
                                            </tr>

</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
				<td>
						<div id="vm_chart";">
<script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
<div class="tradingview-widget-container">


<script type="text/javascript">
new TradingView.widget(
{
	"width": 400,
	"height": 300,
	"symbol": "BINANCE:ETHUSDTPERP",
	"interval": "60",
	"timezone": "Etc/UTC",
	"theme": "Dark",
	"style": "1",
	"locale": "en",
	"toolbar_bg": "#333",
	"enable_publishing": false,
	"hide_legend": true,
	"save_image": false,
"hide_side_toolbar": false,
	"studies": [
			"IchimokuCloud@tv-basicstudies"
	],
	"container_id": "tradingview_5e52b"
}
);
</script>
</div>
</div>

				</td>

		</tr>
				<tr>
						<td align="center" width="100%" style="background:#333;border-left:1px solid #555;border-right:1px solid #555;background:#333;">

<table  border="0" cellpadding="0" cellspacing="0" width="100%">
											<tr>

												<td width="100%" align="center" valign="top" bgcolor="#111" colspan="6">


																<table  border="0" cellpadding="0" cellspacing="0" width="100%" >
																		<tr>

																	<iframe src="https://aggr.trade/" width="100%" height="300" border="0"></iframe>

																		</tr>

																		</table>



													</td>
												</tr>

</table>

<div id="log_locate" style="display:none"></div>
</center>



<script>
function fn_timezone() {
  var offset = new Date().getTimezoneOffset(), o = Math.abs(offset);
  return (offset < 0 ? "+" : "-") + ("00" + Math.floor(o / 60)).slice(-2) + ":" + ("00" + (o % 60)).slice(-2);
}


</script>
</boby>

	</td>

</tr>

    </table>

</div>
</center>

    </body>
    </!html>

<script type="text/javascript">

    var g_wws = 0;


    var wws = {};

    var overtime = 300;



    var g_loop = 30;

    function fn_loop() {
	 if (g_license != 0) {
        if (g_member != 0) {
            g_loop += 1;

            if (g_loop >= 60) {

                g_loop = 0;

                $('#my_menu').css('color', '#52C66C');




                setTimeout("fn_loop_signal();", 100);

            }
        }
	}
    }

    function fn_loop_signal() {
        $('#my_menu').css('color', '#fff');

    }


    //====================================================================================================


    //====================================================================================================


    function fn_connect_api() {

        try {

            wws = new WebSocket("wss://www.bitmex.com/realtime?subscribe=trade:XBTUSD");

            wws.onopen = function () {
                $('#vm_access_msg').html('Connected Public Api. please login to api');
                wws.send('{"op":"subscribe","args":["orderBook10:XBTUSD"]}');

                if (g_wallet == 1) {
                    fn_access();
                }
            }

            wws.onmessage = function (e) {
                fn_rs(e.data);
            }
            wws.onclose = function (e) {
                fn_msg_disconnect("disconnected");

            }
            wws.onerror = function (e) {
                onError(e);
            }



        } catch (exception) {
            alert('Error : ' + exception);

        }
    }




    function onError(evt) {
        $('#order_msg').html('<span style="color: red;">ERROR Bimex V2 API </span> <br> Please wait a while ' + evt.Data);
    }

    function fn_msg_disconnect(e) {

        setTimeout("fn_connect_api()",5000);
    }



    function fn_reconnect() {
        $('#btn_connect').hide();
        window.open('?', '_self');
    }

    //====================================================================================================

    $("#send_q").bind("keypress", function (event) {
        if (event.which == 13) {
            fn_msg_rq();
        }
    });



    var api_ex_date = new Date().getTime();

    var api_key = "";
    var api_sec = "";

    var api_signature = "";
    var verb = 'GET';



    var path = '/api/v1/instrument';
    var api_data = '';

    var img = '';
    var chatlog_buy = [];
    var chatlog_sell = [];
    var msg_count = 0;
    var is_scroll_lock = false;


    function hmac(key, v) {
        var hmacHasher = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, key);
        return hmacHasher.finalize(v).toString();
    }

    function fn_access() {


        api_key = $('#api_key').val();
        api_sig = $('#api_sig').val();

        api_sec = api_sig;

        if (api_key == '') {
            alert('Please input API Key..');
            return;
        }
        if (api_sig == '') {
            alert('Please input API Key..');
            return;
        }

        $('#api_btn').hide();


        $('#vm_access_msg').html('Connecting to BitMex Api, Please wait a while.')

        api_signature = hmac(api_sig, 'GET/realtime' + api_ex_date);

        var cmd;

        cmd = '{"op": "authKeyExpires", "args": ["' + api_key + '", '+api_ex_date+', "'+api_signature+'"]}';

        wws.send(cmd);



    }

    function fn_set_orders(order_id, order_price, order_size, order_delta, order_type) {




        this.order_id = order_id;
        this.order_price = order_price;
        this.order_size = order_size;
        this.order_delta = order_delta;
        this.order_type = order_type;
        this.order_amend = 0;
    }





    var sound_size_sell = 100000;

    var sound_size_buy_now = 0;
    var sound_size_sell_now = 0;
    var sound_size_order = 3000000;


    function fn_vol(vol) {

        g_vol = vol;

        obj_buy.volume = vol;
        obj_sell.volume = vol;

        obj_ac.volume = vol;
        obj_ok.volume = vol;
        obj_error.volume = vol;
        obj_typing.volume = vol;
        obj_alert.volume = vol;


        obj_buy_finex.volume = vol;
        obj_sell_finex.volume = vol;
    }

    function fn_size_order(size) {

        sound_size_order = size;
    }


    function fn_size_sell(size) {

        sound_size_sell = size;
    }

    var on_tb = 0;
    var on_ts = 0;

    function fn_return_long() {

        $("#title_long").toggle();
        $('#trade_long').css('background', '#131722');
        on_tb = 0;
    }
    function fn_return_short() {

        $("#title_short").toggle();
        $('#trade_short').css('background', '#131722');
        on_ts = 0;
    }



    var base_url = 'https://www.bitmex.com/api/v1';


    var api_work = 0;


    /////////////////////////////////////////////////////////////////////////


    function fn_setCookie(cName, cValue, cDay) {
        var expire = new Date();
        expire.setDate(expire.getDate() + cDay);
        cookies = cName + '=' + escape(cValue) + '; path=/ ';
        if (typeof cDay != 'undefined') cookies += ';expires=' + expire.toGMTString() + ';';
        document.cookie = cookies;
    }


    function fn_getCookie(cName) {
        cName = cName + '=';
        var cookieData = document.cookie;
        var start = cookieData.indexOf(cName);
        var cValue = '';
        if (start != -1) {
            start += cName.length;
            var end = cookieData.indexOf(';', start);
            if (end == -1) end = cookieData.length;
            cValue = cookieData.substring(start, end);
        }
        return unescape(cValue);
    }






    function fn_return_buy_lamp() {
        for (var i = 0; i <= 9; i++) {
            $('#bid_' + i + '_2').css('background', '#131722');
        }

    }


    function fn_return_sell_lamp() {
        for (var i = 0; i <= 9; i++) {
            $('#ask_' + i + '_2').css('background', '#131722');
        }


    }



    function fn_set_btn_market() {

        if ($('#view_market').is(":checked")) {

            $('#vm_market_buy').hide();
            $('#vm_market_sell').hide();

        } else {
            $('#vm_market_buy').show();
            $('#vm_market_sell').show();
        }



    }


    function fn_set_btn_chart() {

        if ($('#view_chart').is(":checked")) {
            $('#vm_chart').show();

        } else {
            $('#vm_chart').hide();
        }

    }

</script>



<script type="text/javascript">

    var g_license = 0;

    var g_wallet = 0;
    var g_position = 0;

    var g_member = 0;
    var g_balance = 0;
    var g_pending = 0;

    var g_buy_price = 0;
    var g_sell_price = 0;

    var g_xbt = '';
    var g_xbt_real = 0;
    var g_position_size = 0;
    var g_position_price = 0;
    var g_liquidationPrice = 0;
    var g_position_market_price = 0;
    var g_position_btc = 0;
    var g_marginAvailableMargin = 0;

    var g_marginLeverage = 0;
    var g_leverage = 0;
    var g_marginBalance = 0;

    var g_unrealisedPnl = 0;
    var g_unrealisedPnlPcnt = 0;

    var g_order_buy = [];
    var g_order_sell = [];

    var long_count = 0;
    var short_count = 0;

    var ng_short = 0;
    var ng_long = 0;
    var ng_short_size = 0;
    var ng_long_size = 0;

    var on_bgm = 0;

    var b4_persent = 0;


    var g_5m_buy = 0;
    var g_5m_sell = 0;
    var g_5m_tot = 0;

    var g_5m_cnt_buy = 0;
    var g_5m_cnt_sell = 0;
    var signal_cnt = 0;


    var signal_ai = 0;
    var signal_ai_data = 0;
    var signal_xbt = 0;

    var signal_on_xbt = 0;
    var signal_on_status = 0;

    var on_gxbt = '';

    var on_alert_xbt = 0;


    function fn_rs(txt) {

        g_wws = 0;

        var objs = JSON.parse(txt);


        var msg;




	    if (objs.status == 401) {
	        if (objs["request"].op == 'authKeyExpires') {
	            alert(objs.error);
	            fn_connect_api();

	            $('#api_btn').show();
	        }
	        return;
	    }

	    if (objs.status == 403) {
	        if (objs["request"].op == 'authKeyExpires') {
	            alert(objs.error);
	            fn_connect_api();

	            $('#api_btn').show();
	        }
	        return;
	    }

        if (objs.success) {
            if (objs["request"].op == 'authKeyExpires') {
                g_wallet = 1;
                wws.send('{"op":"subscribe","args":["wallet","margin","order:XBTUSD","position:XBTUSD"]}');

                $('#main_access').hide();
                $('#main_trade').show();

            }

            return;
        }

        if (objs.table == 'trade') {


$(objs["data"]).each(function (i, member) {


    if (objs["data"][i].side == 'Sell') {

        var price = objs["data"][i].price;

        if (ng_short != price) {
            ng_short_size = objs["data"][i].size;
            ng_short = price;
        } else {
            ng_short_size += objs["data"][i].size;
        }

        sound_size_sell_now += parseInt(objs["data"][i].size);


        g_xbt = '<span class="v_short"  style="font-size:1.8rem;" >' + parseFloat(objs["data"][i].price).toFixed(1) + '</span>';
        g_xbt_real = objs["data"][i].price;


        msg = '<span class="v_short0">  $ ' + numberWithCommas(objs["data"][i].size) + '</span> <br>';



        short_count++;


        if (short_count > 100) {

            short_count = 1;


            $("#trade_long_data").html(msg);


        }else{
            $("#trade_long_data").prepend(msg);
        }


    } else {
        g_xbt = '<span class="v_long"  style="font-size:1.8rem;" >' + parseFloat(objs["data"][i].price).toFixed(1) + '</span>';

        g_xbt_real = objs["data"][i].price;
        var price = objs["data"][i].price;

        if (ng_long != price) {
            ng_long_size = objs["data"][i].size;
            ng_long = price;
        } else {
            ng_long_size += objs["data"][i].size;
        }

        sound_size_buy_now += parseInt(objs["data"][i].size);



        var msg = '';
        msg = '<span class="v_long0">  $ ' + numberWithCommas(objs["data"][i].size) + "</span><br>";



        long_count++;

        if (long_count > 100) {

            long_count = 1;


            $("#trade_long_data").html(msg);


        }else{

            $("#trade_long_data").prepend(msg);
        }


    }

    $('#xbt_last').html(g_xbt);

});





var del_vol = 0;


if (sound_size_sell_now >= (sound_size_sell * 10)) {

    del_vol = sound_size_sell * 10;

    $('#ask_0_2').css('background', '#E24B4B');
    $('#ask_1_2').css('background', '#E24B4B');
    $('#ask_2_2').css('background', '#E24B4B');
    $('#ask_3_2').css('background', '#E24B4B');
    $('#ask_4_2').css('background', '#E24B4B');
    $('#ask_5_2').css('background', '#E24B4B');
    $('#ask_6_2').css('background', '#E24B4B');
    $('#ask_7_2').css('background', '#E24B4B');
    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');

    var xx = setTimeout(fn_return_sell_lamp, 100);

} else if (sound_size_sell_now >= (sound_size_sell * 9)) {


    del_vol = sound_size_sell * 9;

    $('#ask_1_2').css('background', '#E24B4B');
    $('#ask_2_2').css('background', '#E24B4B');
    $('#ask_3_2').css('background', '#E24B4B');
    $('#ask_4_2').css('background', '#E24B4B');
    $('#ask_5_2').css('background', '#E24B4B');
    $('#ask_6_2').css('background', '#E24B4B');
    $('#ask_7_2').css('background', '#E24B4B');
    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');

    var xx = setTimeout(fn_return_sell_lamp, 100);
} else if (sound_size_sell_now >= (sound_size_sell * 8)) {


    del_vol = sound_size_sell * 8;

    $('#ask_2_2').css('background', '#E24B4B');
    $('#ask_3_2').css('background', '#E24B4B');
    $('#ask_4_2').css('background', '#E24B4B');
    $('#ask_5_2').css('background', '#E24B4B');
    $('#ask_6_2').css('background', '#E24B4B');
    $('#ask_7_2').css('background', '#E24B4B');
    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');


    var xx = setTimeout(fn_return_sell_lamp, 100);
} else if (sound_size_sell_now >= (sound_size_sell * 7)) {


    del_vol = sound_size_sell * 7;

    $('#ask_3_2').css('background', '#E24B4B');
    $('#ask_4_2').css('background', '#E24B4B');
    $('#ask_5_2').css('background', '#E24B4B');
    $('#ask_6_2').css('background', '#E24B4B');
    $('#ask_7_2').css('background', '#E24B4B');
    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');


    var xx = setTimeout(fn_return_sell_lamp, 100);
} else if (sound_size_sell_now >= (sound_size_sell * 6)) {


    del_vol = sound_size_sell * 6;

    $('#ask_4_2').css('background', '#E24B4B');
    $('#ask_5_2').css('background', '#E24B4B');
    $('#ask_6_2').css('background', '#E24B4B');
    $('#ask_7_2').css('background', '#E24B4B');
    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');



    var xx = setTimeout(fn_return_sell_lamp, 100);
} else if (sound_size_sell_now >= (sound_size_sell * 5)) {


    del_vol = sound_size_sell * 5;

    $('#ask_5_2').css('background', '#E24B4B');
    $('#ask_6_2').css('background', '#E24B4B');
    $('#ask_7_2').css('background', '#E24B4B');
    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');


    var xx = setTimeout(fn_return_sell_lamp, 100);
} else if (sound_size_sell_now >= (sound_size_sell * 4)) {


    del_vol = sound_size_sell * 4;

    $('#ask_6_2').css('background', '#E24B4B');
    $('#ask_7_2').css('background', '#E24B4B');
    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');



    var xx = setTimeout(fn_return_sell_lamp, 100);

} else if (sound_size_sell_now >= (sound_size_sell * 3)) {


    del_vol = sound_size_sell * 3;
    $('#ask_7_2').css('background', '#E24B4B');
    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');

    var xx = setTimeout(fn_return_sell_lamp, 100);

} else if (sound_size_sell_now >= (sound_size_sell * 2)) {


    del_vol = sound_size_sell * 2;


    $('#ask_8_2').css('background', '#E24B4B');
    $('#ask_9_2').css('background', '#E24B4B');
    var xx = setTimeout(fn_return_sell_lamp, 100);

} else if (sound_size_sell_now >= sound_size_sell) {
    del_vol = sound_size_sell * 1;

    $('#ask_9_2').css('background', '#E24B4B');
    var xx = setTimeout(fn_return_sell_lamp, 100);
}




if (sound_size_sell_now >= sound_size_sell) {



    sound_size_sell_now = sound_size_sell_now - del_vol;




}




if (sound_size_buy_now >= (sound_size_sell * 10)) {


    del_vol = sound_size_sell * 10;

    $('#bid_0_2').css('background', '#0089a1');
    $('#bid_1_2').css('background', '#0089a1');
    $('#bid_2_2').css('background', '#0089a1');
    $('#bid_3_2').css('background', '#0089a1');
    $('#bid_4_2').css('background', '#0089a1');
    $('#bid_5_2').css('background', '#0089a1');
    $('#bid_6_2').css('background', '#0089a1');
    $('#bid_7_2').css('background', '#0089a1');
    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');

    var xx = setTimeout(fn_return_buy_lamp, 100);

} else if (sound_size_buy_now >= (sound_size_sell * 9)) {

    del_vol = sound_size_sell * 9;

    $('#bid_1_2').css('background', '#0089a1');
    $('#bid_2_2').css('background', '#0089a1');
    $('#bid_3_2').css('background', '#0089a1');
    $('#bid_4_2').css('background', '#0089a1');
    $('#bid_5_2').css('background', '#0089a1');
    $('#bid_6_2').css('background', '#0089a1');
    $('#bid_7_2').css('background', '#0089a1');
    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');

    var xx = setTimeout(fn_return_buy_lamp, 100);


} else if (sound_size_buy_now >= (sound_size_sell * 8)) {


    del_vol = sound_size_sell * 8;

    $('#bid_2_2').css('background', '#0089a1');
    $('#bid_3_2').css('background', '#0089a1');
    $('#bid_4_2').css('background', '#0089a1');
    $('#bid_5_2').css('background', '#0089a1');
    $('#bid_6_2').css('background', '#0089a1');
    $('#bid_7_2').css('background', '#0089a1');
    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');

    var xx = setTimeout(fn_return_buy_lamp, 100);

} else if (sound_size_buy_now >= (sound_size_sell * 7)) {

    del_vol = sound_size_sell * 7;

    $('#bid_3_2').css('background', '#0089a1');
    $('#bid_4_2').css('background', '#0089a1');
    $('#bid_5_2').css('background', '#0089a1');
    $('#bid_6_').css('background', '#0089a1');
    $('#bid_7_2').css('background', '#0089a1');
    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');

    var xx = setTimeout(fn_return_buy_lamp, 100);
} else if (sound_size_buy_now >= (sound_size_sell * 6)) {


    del_vol = sound_size_sell * 6;


    $('#bid_4_2').css('background', '#0089a1');
    $('#bid_5_2').css('background', '#0089a1');
    $('#bid_6_2').css('background', '#0089a1');
    $('#bid_7_2').css('background', '#0089a1');
    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');

    var xx = setTimeout(fn_return_buy_lamp, 100);
} else if (sound_size_buy_now >= (sound_size_sell * 5)) {


    del_vol = sound_size_sell * 5;

    $('#bid_5_2').css('background', '#0089a1');
    $('#bid_6_2').css('background', '#0089a1');
    $('#bid_7_2').css('background', '#0089a1');
    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');

    var xx = setTimeout(fn_return_buy_lamp, 100);

} else if (sound_size_buy_now >= (sound_size_sell * 4)) {


    del_vol = sound_size_sell * 4;

    $('#bid_6_2').css('background', '#0089a1');
    $('#bid_7_2').css('background', '#0089a1');
    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');

    var xx = setTimeout(fn_return_buy_lamp, 100);
} else if (sound_size_buy_now >= (sound_size_sell * 3)) {

    del_vol = sound_size_sell * 3;


    $('#bid_7_2').css('background', '#0089a1');
    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');

    var xx = setTimeout(fn_return_buy_lamp, 100);

} else if (sound_size_buy_now >= (sound_size_sell * 2)) {


    del_vol = sound_size_sell * 2;

    $('#bid_8_2').css('background', '#0089a1');
    $('#bid_9_2').css('background', '#0089a1');
    var xx = setTimeout(fn_return_buy_lamp, 100);

} else if (sound_size_buy_now >= sound_size_sell) {

    del_vol = sound_size_sell;

    $('#bid_9_2').css('background', '#0089a1');
    var xx = setTimeout(fn_return_buy_lamp, 100);
}



if (sound_size_buy_now >= sound_size_sell) {

    sound_size_buy_now = sound_size_buy_now - del_vol;



}




}else if (objs.table == 'orderBook10') {
            var shorts = '';
            var longs = '';

            var buy_price = 0;
            var sell_price = 0;

            var tot_buy = 0;
            var tot_sell = 0;

            var fir_vol1 = 0;
            var fir_vol2 = 0;

            var check_my = 0;

            var tt_buy = 0;
            var tt_sell = 0;
            $(objs["data"][0].bids).each(function (i, member) {
                tt_buy = parseFloat(tt_buy) + parseFloat(objs["data"][0].bids[i][1]);
                tt_sell = parseFloat(tt_sell) + parseFloat(objs["data"][0].asks[i][1]);

                }
            );


            $(objs["data"][0].bids).each(function (i, member) {
                tot_buy += objs["data"][0].bids[i][1];
                if (i == 0) {
                    buy_price = objs["data"][0].bids[i][0];
                    fir_vol1 = objs["data"][0].bids[i][1];

                    g_buy_price = buy_price;
                }

                check_my = 0;

                for (var x = 0; x < g_order_buy.length; x++) {
                    order = g_order_buy[x];

                    if (parseFloat(order.order_price) == parseFloat(objs["data"][0].bids[i][0])) {
                        check_my = 1;
                    }
                }
    ///////////////////////////////////
              //  $('#bid_' + i + '_1').html(numberWithCommas(tot_buy));

                if (check_my == 1) {
                    $('#bid_' + i + '_2').html('<span style="color:#ffcc00;">' + numberWithCommas(objs["data"][0].bids[i][1]) + '</span>' );
                } else {
                    $('#bid_' + i + '_2').html(numberWithCommas(objs["data"][0].bids[i][1]));
                }

                var now_my_offer = 0;
                now_my_offer = $('#btn_buy_post_price').val();

                if (parseFloat(now_my_offer) == parseFloat(objs["data"][0].bids[i][0])) {

                    $('#bid_' + i + '_3').html('<span style="color:#ffcc00;">'+numberWithCommas(numberWithCommas(parseFloat(objs["data"][0].bids[i][0]).toFixed(1)))+'</span>');
                } else {
                    $('#bid_' + i + '_3').html(numberWithCommas(numberWithCommas(parseFloat(objs["data"][0].bids[i][0]).toFixed(1))));
                }

                var av = parseFloat(tot_buy / tt_buy * 100);
                av = 100 - av;
                $('#bid_' + i + '_4').css('width', av+'%');
            });






            if ($('#btn_buy_post_price_check').is(":checked")) {

                if ($('#btn_buy_post_price_check').is(":checked")) {
                    var sp = $('#btn_buy_post_price_sp').val();
                    sp = sp.trim();
                    if (sp == '') {
                        sp = 0;
                    }
                    buy_price = parseFloat(buy_price) - parseFloat(sp);

                }

                $('#btn_buy_post_price').val(buy_price);
            }





            $(objs["data"][0].asks).each(function (i, member) {
                tot_sell += objs["data"][0].asks[i][1];
                if (i == 0) {
                    sell_price = objs["data"][0].asks[i][0];
                    fir_vol2 = objs["data"][0].asks[i][1];

                    g_sell_price = sell_price;

                }

                check_my = 0;

                for (var x = 0; x < g_order_sell.length; x++) {
                    order = g_order_sell[x];

                    if (parseFloat(order.order_price) == parseFloat(objs["data"][0].asks[i][0])) {
                        check_my = 1;
                    }
                }



                $('#ask_' + i + '_1').html(numberWithCommas(tot_sell));

                if (check_my == 1) {
                    $('#ask_' + i + '_2').html('<span style="color:#ffcc00;">' + numberWithCommas(objs["data"][0].asks[i][1])+'</span>');
                } else {
                    $('#ask_' + i + '_2').html(numberWithCommas(objs["data"][0].asks[i][1]));
                }

                var now_my_offer_sell = 0;
                now_my_offer_sell = $('#btn_sell_post_price').val();

                if (parseFloat(now_my_offer_sell) == parseFloat(objs["data"][0].asks[i][0])) {
                    $('#ask_' + i + '_3').html(numberWithCommas('<span style="color:#ffcc00;">' + numberWithCommas(parseFloat(objs["data"][0].asks[i][0]).toFixed(1))) + '</span>');
                } else {
                    $('#ask_' + i + '_3').html(numberWithCommas(numberWithCommas(parseFloat(objs["data"][0].asks[i][0]).toFixed(1))));
                }

                var av = parseFloat(tot_sell / tt_sell * 100);

                $('#ask_' + i + '_4').css('width', av + '%');

            });



            if ($('#btn_sell_post_price_check').is(":checked")) {

                if ($('#btn_sell_post_price_check').is(":checked")) {
                    var sp = $('#btn_sell_post_price_sp').val();
                    sp = sp.trim();
                    if (sp == '') {
                        sp = 0;
                    }
                    sell_price = parseFloat(sell_price) + parseFloat(sp);

                }



                $('#btn_sell_post_price').val(sell_price);
            }


            //$('#order_ask').html(shorts);
            //$('#order_bid').html(longs);


            $('#order_tot_buy').html(numberWithCommas(tot_buy));
            $('#order_tot_sell').html(numberWithCommas(tot_sell));

            var tot = 0;
            tot = parseFloat(tot_sell) + parseFloat(tot_buy);

            var av1 = parseFloat(tot_buy / tot * 100);
            var av2 = parseFloat(tot_sell / tot * 100);


            if (av1 > av2) {
                $('#tot_buy_percent').html('<span style="color:#52C66C">' + parseFloat(av1).toFixed(2) + '<br> %</span>');
                if (b4_persent != 1) {

                    b4_persent = 1;
                }
            } else {
                $('#tot_buy_percent').html(parseFloat(av1).toFixed(2) + '<br> %');
            }

            if (av1 < av2) {
                $('#tot_sell_percent').html('<span style="color:#52C66C">' + parseFloat(av2).toFixed(2) + '<br> %</span>');
                if (b4_persent != 2) {

                    b4_persent = 2;
                }
            } else {
                $('#tot_sell_percent').html(parseFloat(av2).toFixed(2) + '<br> %');
            }




            var order;
            /*

            for (var i = 0; i < g_order_buy.length; i++) {
                order = g_order_buy[i];

                if (order.order_amend == 1) {

                    if (buy_price != order.order_price) {
                        //$('#debug').html(order.order_id + ' ' + order.order_price );


                    }

                }
            }

            for (var i = 0; i < g_order_sell.length; i++) {
                order = g_order_sell[i];

                if (order.order_amend == 1) {

                    if (sell_price != order.order_price) {
                        //fn_mex_amend(order.order_id, sell_price);
                    }

                }
            }

            */

        } else if (objs.table == 'position') {


            $(objs["data"]).each(function (i, member) {


                if (objs["data"][0].leverage != null) {
                    g_leverage = objs["data"][0].leverage;

                    var leverage;
                    if (g_leverage == 0 || g_leverage == 100) {
                        leverage = 'Cross';
                    } else {
                        leverage = g_leverage + ' x';
                    }
                    $('#position_leverage').html('' + parseFloat(g_marginLeverage).toFixed(2) + ' x / ' + '<span style="color:#fff;">' + leverage + '</span');

                }

                if (objs["data"][i].currentQty != null) {
                    g_position_size = objs["data"][i].currentQty;

                    if (g_position_size == 0) {
                        $('#position_style').css('background', 'linear-gradient( to bottom, #999, #555 )');

                        g_liquidationPrice = 0;
                        g_position_price = 0;
                        g_position_market_price = 0;
                        g_unrealisedPnl = 0;
                        g_unrealisedPnlPcnt = 0;
                        g_position_btc = 0;



                        $('#pos_profit').html("");
                        $('#pos_price').html("");
                        $('#pos_size').html("");
                        $('#pos_liq').html("");

                        $('#pos_market_price').html("");

                        $('#pos_pnl').html("");
                        $('#pos_profit_btc').html("");

                        $('#pos_btc').html("");

                        return;
                    }
                }




                if (objs["data"][i].liquidationPrice != null) {
                    g_liquidationPrice = objs["data"][i].liquidationPrice;
                }

                if (objs["data"][i].avgCostPrice != null) {
                    g_position_price = objs["data"][i].avgCostPrice;
                }

                if (objs["data"][i].markPrice != null) {
                    g_position_market_price = objs["data"][i].markPrice;
                }
                if (objs["data"][i].unrealisedPnl != null) {
                    g_unrealisedPnl = objs["data"][i].unrealisedPnl;
                }

                if (objs["data"][i].unrealisedRoePcnt != null) {
                    g_unrealisedPnlPcnt = objs["data"][i].unrealisedRoePcnt;
                }
                if (objs["data"][i].posCost != null) {
                    g_position_btc = objs["data"][i].posCost;


                }

                var sum = 0;

                if (g_position_size > 0) {
                    g_position = 1;

                    $('#position_style').css('background', 'linear-gradient( to bottom, #318ce7, #166ec5 )');
                    if (g_xbt_real != 0) {
                        sum = (g_position_price - g_xbt_real);
                        sum = sum * (g_position_btc / 100000000);

                        if (sum >= 0) {
                            $('#pos_profit').html('<span style="color:#65fd36">' + parseFloat(sum).toFixed(2) + '</span>');
                        } else {
                            $('#pos_profit').html('<span style="color:#ff6683">' + parseFloat(sum).toFixed(2) + '</span>');
                        }

                        var sum_btc = 0;

                        sum_btc = (g_position_price - g_xbt_real);
                        sum_btc = sum_btc * (g_position_btc / 100000000);
                        sum_btc = sum_btc / g_xbt_real;

                        if (sum_btc >= 0) {
                            $('#pos_profit_btc').html('<span style="color:#65fd36">' + parseFloat(sum_btc).toFixed(4) + '</span>');
                        } else {
                            $('#pos_profit_btc').html('<span style="color:#ff6683">' + parseFloat(sum_btc).toFixed(4) + '</span>');
                        }


                    }

                    $('#pos_price').html(g_position_price);
                    $('#pos_size').html(g_position_size);
                    $('#pos_liq').html(g_liquidationPrice);

                    $('#pos_market_price').html(g_position_market_price);


                    if (g_unrealisedPnl > 0) {
                        $('#pos_pnl').html('<span style="color:#65fd36">' + parseFloat(g_unrealisedPnl / 100000000).toFixed(6) + ' (' + parseFloat(g_unrealisedPnlPcnt * 100).toFixed(2) + ' %' + ')</span>');
                    } else if (g_unrealisedPnl < 0) {
                        $('#pos_pnl').html('<span style="color:#ff6683">' + parseFloat(g_unrealisedPnl / 100000000).toFixed(6) + ' (' + parseFloat(g_unrealisedPnlPcnt * 100).toFixed(2) + ' %' + ')</span>');
                    } else {
                        $('#pos_pnl').html('<span style="color:#fff">' + parseFloat(g_unrealisedPnl / 100000000).toFixed(6) + ' (' + parseFloat(g_unrealisedPnlPcnt * 100).toFixed(2) + ' %' + ')</span>');
                    }


                   $('#pos_btc').html(parseFloat((g_position_btc / 100000000) * -1).toFixed(6));




                } else  if (g_position_size < 0) {
                    g_position = 2;

                    $('#position_style').css('background', 'linear-gradient( to bottom, #89443a, #5d2820 )');


                    if (g_xbt_real != 0) {

                        sum = (g_position_price - g_xbt_real);
                        sum = sum * (g_position_btc / 100000000);


                        if (sum >= 0) {
                            $('#pos_profit').html('<span style="color:#65fd36">' + parseFloat(sum).toFixed(2) + '</span>');
                        } else {
                            $('#pos_profit').html('<span style="color:#ff6683">' + parseFloat(sum).toFixed(2) + '</span>');
                        }

                        var sum_btc = 0;

                        sum_btc = (g_position_price - g_xbt_real);
                        sum_btc = sum_btc * (g_position_btc / 100000000);
                        sum_btc = sum_btc / g_xbt_real;

                        if (sum_btc >= 0) {
                            $('#pos_profit_btc').html('<span style="color:#65fd36">' + parseFloat(sum_btc).toFixed(4) + '</span>');
                        } else {
                            $('#pos_profit_btc').html('<span style="color:#ff6683">' + parseFloat(sum_btc).toFixed(4) + '</span>');
                        }


                    }

                    $('#pos_price').html(g_position_price);
                    $('#pos_size').html(numberWithCommas(g_position_size * -1));
                    $('#pos_liq').html(g_liquidationPrice);

                    $('#pos_market_price').html(g_position_market_price);

                    if (g_unrealisedPnl > 0) {
                        $('#pos_pnl').html('<span style="color:#65fd36">' + parseFloat(g_unrealisedPnl / 100000000).toFixed(6) + ' (' + parseFloat(g_unrealisedPnlPcnt * 100).toFixed(2) + ' %' + ')</span>');
                    } else if (g_unrealisedPnl < 0) {
                        $('#pos_pnl').html('<span style="color:#ff6683">' + parseFloat(g_unrealisedPnl / 100000000).toFixed(6) + ' (' + parseFloat(g_unrealisedPnlPcnt * 100).toFixed(2) + ' %' + ')</span>');
                    } else {
                        $('#pos_pnl').html('<span style="color:#fff">' + parseFloat(g_unrealisedPnl / 100000000).toFixed(6) + ' (' + parseFloat(g_unrealisedPnlPcnt * 100).toFixed(2) + ' %' + ')</span>');
                    }



                    $('#pos_btc').html(parseFloat(g_position_btc / 100000000).toFixed(6));



                }


            });

        } else if (objs.table == 'order') {

            var order = null;
            var workingIndicator = '';


            if (objs.action == 'update') {

                $(objs["data"]).each(function (i, member) {

                    var status = '';

                    if (objs["data"][i].ordStatus != null) {

                        status = objs["data"][i].ordStatus;

                    } else {


                        if (objs["data"][i].price != null) {
                            var order_id = objs["data"][i].orderID;

                            for (var x = 0; x < g_order_buy.length; x++) {
                                order = g_order_buy[x];
                                if (order.order_id == order_id) {
                                    order.order_price = objs["data"][i].price;
                                    g_order_buy[x] = order;
                                }
                            }
                            for (var x = 0; x < g_order_sell.length; x++) {
                                order = g_order_sell[x];
                                if (order.order_id == order_id) {
                                    order.order_price = objs["data"][i].price;
                                    g_order_sell[x] = order;
                                }
                            }
                        }
                        if (objs["data"][i].stopPx != null) {
                            var order_id = objs["data"][i].orderID;

                            for (var x = 0; x < g_order_buy.length; x++) {
                                order = g_order_buy[x];
                                if (order.order_id == order_id) {
                                    order.order_price = objs["data"][i].stopPx;
                                    g_order_buy[x] = order;
                                }
                            }
                            for (var x = 0; x < g_order_sell.length; x++) {
                                order = g_order_sell[x];
                                if (order.order_id == order_id) {
                                    order.order_price = objs["data"][i].stopPx;
                                    g_order_sell[x] = order;
                                }
                            }
                        }

                    }

                    if (objs["data"][i].workingIndicator != null) {         // order fix ?? ?? ?? ??? ?? ??.

                        workingIndicator = objs["data"][i].workingIndicator;

                    }


                    if (status == 'Canceled' || status == 'Rejected') {

                        var order;

                        var order_id = objs["data"][i].orderID;

                        $('#' + order_id).remove();

                        for (var x = 0; x < g_order_buy.length; x++) {
                            order = g_order_buy.shift();
                            if (order.order_id != order_id) {
                                g_order_buy.push(order);
                            }
                        }

                        for (var x = 0; x < g_order_sell.length; x++) {
                            order = g_order_sell.shift();
                            if (order.order_id != order_id) {
                                g_order_sell.push(order);
                            }
                        }

                    } else if (status == 'Filled') {

                        var order;

                        var order_id = objs["data"][i].orderID;

                        $('#' + order_id).remove();

                        for (var x = 0; x < g_order_buy.length; x++) {
                            order = g_order_buy.shift();
                            if (order.order_id != order_id) {
                                g_order_buy.push(order);
                            }
                        }
                        for (var x = 0; x < g_order_sell.length; x++) {
                            order = g_order_sell.shift();
                            if (order.order_id != order_id) {
                                g_order_sell.push(order);
                            }
                        }
                    } else {
                        if (workingIndicator == false) {
                            /*
                            var order_price;
                            if (objs["data"][i].price != null) {
                                var order_price = objs["data"][i].price;

                                for (var i = 0; i < g_order_buy.length; i++) {
                                    order = g_order_buy.shift();
                                    if (order.order_id == order_id) {

                                        order.price = order_price;
                                        g_order_buy.push(order);
                                    } else {
                                        g_order_buy.push(order);
                                    }
                                }
                            }
                            */
                        }


                    }

                });
            } else if (objs.action == 'insert' || objs.action == 'partial') {



                if (objs.action == 'partial') {

                    g_order_buy = [];
                    g_order_sell = [];



                }
                if (objs.action == 'insert') {

                    $(objs["data"]).each(function (i, member) {

                        if (objs["data"][i].price == null) {
                            return;
                        }
                    });


                }

                $(objs["data"]).each(function (i, member) {




                    var order_id;
                    var order_price;
                    var order_size;
                    var order_delta;
                    var order_type;
                    var order_side;

                    order_side = objs["data"][i].side;

                    order_id = objs["data"][i].orderID;

                    if (objs["data"][i].price != null) {
                        order_price = objs["data"][i].price;
                    } else {
                        order_price = 0;
                    }
                    if (objs["data"][i].orderQty != null) {
                        order_size = objs["data"][i].orderQty;
                    }
                    if (objs["data"][i].simpleCumQty != null) {
                        order_delta = objs["data"][i].simpleCumQty;
                    }
                    if (objs["data"][i].execInst != null) {
                        order_type = objs["data"][i].execInst;
                        if (order_type == 'ParticipateDoNotInitiate') {
                            order_type = 1;
                        } else if (order_type == 'ParticipateDoNotInitiate,ReduceOnly') {
                            order_type = 2;
                        } else if (order_type == 'ReduceOnly') {
                            order_type = 3;
                        } else if (order_type == 'Close,LastPrice') {
                            order_type = 11;
                            if (order_price == 0) {
                                if (objs["data"][i].stopPx != null) {
                                    order_price = objs["data"][i].stopPx;
                                }

                            }
                        } else if (order_type == 'Close,LastPrice,ParticipateDoNotInitiate') {
                            order_type = 21;
                            if (order_price == 0) {
                                if (objs["data"][i].stopPx != null) {
                                    order_price = objs["data"][i].stopPx;
                                }

                            }

                        } else {
                            order_type = 0;
                        }
                    }




                    if (order_side == 'Sell') {
                        var status_cc = 0;
                        var chk_order;

                        for (var x = 0; x < g_order_sell.length; x++) {
                            chk_order = g_order_sell[x];
                            if (chk_order.order_id == order_id) {
                                status_cc = 1;
                            }
                        }
                        if (status_cc != 0) {
                            return;
                        }


                        order = new fn_set_orders(order_id, order_price, order_size, order_delta, order_type);
                        g_order_sell.push(order);
                    }


                    if (order_side == 'Buy') {

                        var status_cc = 0;
                        var chk_order;

                        for (var x = 0; x < g_order_buy.length; x++) {
                            chk_order = g_order_buy[x];
                            if (chk_order.order_id == order_id) {
                                status_cc = 1;
                            }
                        }
                        if (status_cc != 0) {
                            return;
                        }


                        order = new fn_set_orders(order_id, order_price, order_size, order_delta, order_type);
                        g_order_buy.push(order);
                    }

                });
            }
            var iHtml = "";

            if (g_order_sell.length >= 1) {

                g_order_sell.sort(function (a, b) {
                    return a.order_price < b.order_price ? -1 : a.order_price > b.order_price ? 1 : 0;

                });

                for (var i = 0; i < g_order_sell.length; i++) {
                    var order = g_order_sell[i];
                    iHtml += '<div id="' + order.order_id + '">';
                    iHtml += '<table width="100%" border="0" cellpadding="0" cellspacing="0">';
                    iHtml += "			  <tr>";

                    if (order.order_type == 1) {
                        iHtml += "				<td width='25%' class='v_orders_sell' align='center'>P</td>";
                    } else if (order.order_type == 2) {
                        iHtml += "				<td width='25%' class='v_orders_sell' align='center'>P/R</td>";
                    } else if (order.order_type == 3) {
                        iHtml += "				<td width='25%' class='v_orders_sell' align='center'>R</td>";
                    } else if (order.order_type == 11) {
                        iHtml += "				<td width='25%' class='v_orders_sell' align='center'>Stop</td>";
                    } else if (order.order_type == 21) {
                        iHtml += "				<td width='25%' class='v_orders_sell' align='center'>Stop/P.fit</td>";
                    } else {
                        iHtml += "				<td width='25%' class='v_orders_sell' align='center'>-</td>";
                    }

                    iHtml += "				<td width='25%' class='v_orders_sell' align='center'>" + order.order_price + "</td>";
                    iHtml += "				<td width='25%' class='v_orders_sell' align='center'>" + order.order_size + "</td>";
                    iHtml += "				<td width='25%' class='v_orders_sell_btn' align='center'  onclick='fn_mex_order_cancel(\"" + order.order_id + "\");' ><i class='fa fa-fw fa-times-circle'></i></td>";

                    iHtml += "			  </tr>";
                    iHtml += "</table></div>";
                }


                $('#order_sell_list').html(iHtml);
            }
            iHtml = "";

            if (g_order_buy.length >= 1) {


                g_order_buy.sort(function (a, b) {
                    return a.order_price > b.order_price ? -1 : a.order_price < b.order_price ? 1 : 0;

                });


                for (var i = 0; i < g_order_buy.length; i++) {
                    var order = g_order_buy[i];
                    iHtml += '<div id="' + order.order_id + '">';
                    iHtml += '<table width="100%" border="0" cellpadding="0" cellspacing="0">';
                    iHtml += "			  <tr>";

                    if (order.order_type == 1) {
                        iHtml += "				<td width='25%' class='v_orders_buy' align='center'>P</td>";
                    } else if (order.order_type == 2) {
                        iHtml += "				<td width='25%' class='v_orders_buy' align='center'>P/R</td>";
                    } else if (order.order_type == 3) {
                        iHtml += "				<td width='25%' class='v_orders_buy' align='center'>R</td>";
                    } else if (order.order_type == 11) {
                        iHtml += "				<td width='25%' class='v_orders_buy' align='center'>Stop</td>";
                    } else if (order.order_type == 21) {
                        iHtml += "				<td width='25%' class='v_orders_buy' align='center'>Stop/P.fit</td>";
                    } else {
                        iHtml += "				<td width='25%' class='v_orders_buy' align='center'>-</td>";
                    }


                    iHtml += "				<td width='25%' class='v_orders_buy' align='center'>" + order.order_price + "</td>";
                    iHtml += "				<td width='25%' class='v_orders_buy' align='center'>" + order.order_size + "</td>";
                    iHtml += "				<td width='20%' class='v_orders_buy_btn' align='center' onclick='fn_mex_order_cancel(\"" + order.order_id + "\");' ><i class='fa fa-fw fa-times-circle'></i></td>";
                    iHtml += "			  </tr>";
                    iHtml += "</table></div>";
                }


                $('#order_buy_list').html(iHtml);

            }


        } else {

            $('#order_msg').html(txt);
        }



    }

    var order_lev = 0;


    function fn_order_lev(lev) {

        $('#order_leverage').val(lev);

        $('#order_leverage').css('background', '#65fd36');
        $('#order_leverage').css('color', '#000');
        order_lev = lev;

    }

    function fn_order_lev_done() {
        $('#order_leverage').css('background', '#333');
        $('#order_leverage').css('color', '#fff');
    }

    function fn_order_lev_num(lev) {
        order_lev = lev.trim();

        if (order_lev >= 100) {
            order_lev = 100;
        }
        if (order_lev <= 0) {
            order_lev = 0;
        }


        $('#order_lev').val(order_lev);

    }

</script>






<script language="javascript">





    var gmt = fn_timezone();




    $(document).ready(function () {

        fn_connect_api();











    });






</script>
